# Сервис шардирования баз данных

## Обзор проекта

Данный проект представляет собой реализацию системы **горизонтального шардирования баз данных** на основе **Spring Boot**. Система разработана для эффективного распределения данных пользователей между несколькими экземплярами PostgreSQL, что обеспечивает:

- Повышенную производительность
- Масштабируемость приложения
- Отказоустойчивость

## Реализованная функциональность

### Механизм горизонтального шардирования
- Распределение данных между **тремя независимыми шардами** PostgreSQL
- Динамическая маршрутизация запросов на соответствующий шард

### Инфраструктура баз данных
- Настройка трех экземпляров PostgreSQL с использованием **Docker Compose**
- Конфигурация соединений для каждого шарда с индивидуальными настройками

### Архитектура маршрутизации
- Реализация `AbstractRoutingDataSource` для динамического переключения между источниками данных
- Использование `ThreadLocal` для сохранения контекста текущего шарда

### Алгоритм распределения данных
- Определение шарда на основе **UUID пользователя** (метод суммирования символов)
- Распределение запросов по модулю от количества шардов

### REST API для работы с данными
- `POST /users` - создание пользователей с автоматическим определением шарда
- `GET /users` - получение списка всех пользователей (объединение данных из всех шардов)
- `GET /users/{id}` - поиск пользователя с маршрутизацией в соответствующий шард

### Управление транзакциями
- Корректная обработка транзакций в контексте распределенных БД
- Обеспечение целостности данных при работе с несколькими источниками

**Алгоритм шардирования:**
1. Для каждого пользователя вычисляется сумма кодов символов его UUID
2. Результат делится по модулю на количество шардов
3. Определяется целевой шард (0, 1 или 2)
4. Запрос динамически перенаправляется в соответствующую БД

### Преимущества подхода
✅ Масштабируемость - возможность добавления новых шардов при росте объема данных
✅ Производительность - распределение нагрузки между несколькими БД
✅ Отказоустойчивость - проблемы в одном шарде не влияют на другие
✅ Гибкость - возможность модификации стратегии шардирования
